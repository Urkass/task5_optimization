# Домашнее задание по Клиентской Оптимизации
## Клиентская оптимизация [lifehacker.ru](https://lifehacker.ru/)
400 запросов и размер загрузки в 18.2 МБ пугает. Разберемся, что тут не так.
### Общее
* Gzip сжатие используется не на все ресурсы. Включить Gzip сжатие на все ресурсы.
* Большое количество запросов на один домен. Объединить файлы и/или использовать CDN.
* Включить кэширование на все ресурсы. Увеличить время кэширования там, где целесообразно.

### CSS
* Изменить порядок подключения стилей. Самые критичные стили оставить в < head > или заинлаинить. Остальные перенести в конец < body >. Использовать media запросы для подключения стилей там, где необходимо.
* Большое количество файлов. Возможно, стоит объединить их, сократив количество запросов.
* 89% CSS правил на странице не используются. Удалить их. Например, в [данном файле](https://lifehacker.ru/wp-content/plugins/jetpack/css/jetpack.css?ver=4.1.1) 88% CSS кода не используется.
* Некоторые стили можно минифицировать и обфусцировать, сократив размер файла. Например, [этот файл](https://lifehacker.ru/wp-content/themes/lifehacker/static/fonts/style.css?ver=13).
* Sourcemaps можно удалить. В продакшене - лишние килобайты.

### HTML
* Можно минифицировать и удалить комментарии.

### Javascript
* Изменить порядок подключения скриптов. Убрать блокирующие скрипты из < head > в конец < body >. Использовать async/defer.
* Большое количество файлов. Возможно, стоит объединить их, сократив количество запросов.
* Стоит отрефакторить код. Скорее всего, в скриптах есть большое количество неиспользуемого кода.
* Некоторые скрипты можно минифицировать и обфусцировать, сократив размер файла.
* Использование библиотеки Jquery. Считаю, что сейчас нативный JS позволяет также удобно работать с кодом, как и Jquery, и тащить лишнюю библиотеку нецелесообразно.

### Картинки
* Сайт новостной. Каждая новость, включая и главную, и дополнительные, имеет картинку. Картинки больше чем все остальные ресурсы оттягощают загрузку сайта, их 93-94%. Стоит провести анализ, влияет ли на данном сайте такое количество картинок на посещаемость. Может быть, стоит оставлять некоторые маленькие новости без картинок, показывая их только с названием и описанием. Или выводить не все рубрики с таким большим количеством картинок, а как-то перераспределить их на другие страницы сайта.

* Неподходящие растровые форматы. Например, в [данном месте](https://github.com/Urkass/task5_optimization/tree/master/screenshots/png.png) используется PNG. Стоит заменить на JPEG или webp. Необходимо выбирать наиболее подходящие растровые форматы.

* В некоторых местах картинки не обрезаны или не отмасштабированы. Например, для контейнера размером 465 х 232 загружается картинка размером 2500 x 1250 -  [скриншот](https://github.com/Urkass/task5_optimization/tree/master/screenshots/scale1.png). Вот [другой пример](https://github.com/Urkass/task5_optimization/tree/master/screenshots/scale2.png). Стоит загружать заранее отмасштабированные картинки.

* На мобильных устройствах изображения не оптимизированы под размер экрана. Стоит подготовить под различные устройства картинки разного размера и вставить, используя тэг picture, аттрибут srcset у тэга img или media-queries.

* Все картинки необходимо оптимизировать. Например, [данную картинку](https://lifehacker.ru/wp-content/uploads/2016/08/salmonburger_1470122910-630x315.jpg) можно сжать без потерь, уменьшив ее изначальный вес на 2.3%. Сжать ее с потерями, не видимыми человеческому глазу можно на 15%. Итоговый вес снизится с 25 Килобайт до 20 Килобайт.

* Необходимо минифицировать и сжать все SVG ресурсы. Например, [данную иконку](https://lifehacker.ru/wp-content/themes/lifehacker/static/img/category-icons/life.svg) svgo сжал с 2 КБ до 866 Байт, т.е. более чем в 2 раза.

* SVG иконки бокового меню можно объединить в один спрайт.

### Шрифты
* Для некоторых иконок используется шрифт icomoon. Мне кажется, что в данном случае лучше добавить SVG спрайт с нужными иконками, чем тащить за собой целый шрифт.
* Загружаются расширенные версии шрифтов, симолы которых не используется. Удалить лишние версии.

## Клиентская оптимизация [roomfi.ru](http://roomfi.ru/)
Главная страница данного сайта довольно быстро загружается, но, как известно, нет предела совершенству. Многие проблемы идентичны проблемам лайфхакера, но их поменьше.

### Общее
* Большое количество запросов на один домен. Объединить файлы и/или использовать CDN.
* Включить кэширование на все ресурсы. Увеличить время кэширования там, где целесообразно.

### CSS
* Изменить порядок подключения стилей. Самые критичные стили оставить в < head > или заинлаинить. Остальные перенести в конец < body >. Использовать media запросы для подключения стилей там, где необходимо.
* Стоит объединить css файлы, сократив количество запросов.
* 84% CSS правил на странице не используются. Например, из подключенного Bootstrap используется не более десятка css правил.
* Некоторые стили можно минифицировать и обфусцировать, сократив размер файла. Например, [этот файл](http://roomfi.ru/template_main/css/style.css?v=10).

### HTML
* Можно минифицировать и удалить комментарии.

### Javascript
* Изменить порядок подключения скриптов. Убрать блокирующие скрипты из < head > в конец < body >. Использовать async/defer.
* Стоит объединить js файлы, сократив количество запросов.
* Стоит отрефакторить код. Скорее всего, в скриптах есть большое количество неиспользуемого кода. Например, я уверен, что из подключенного js bootstrap используется малая его часть.
* Некоторые скрипты можно минифицировать и обфусцировать, сократив размер файла. Например, [этот](http://roomfi.ru/template_main/js/classie.js)


### Картинки

* В некоторых местах картинки не обрезаны или не отмасштабированы. Например, для контейнера размером 266 х 174 загружается картинка размером 720 x 540 -  [скриншот](https://github.com/Urkass/task5_optimization/tree/master/screenshots/roomfi.png). Стоит загружать заранее отмасштабированные картинки.

* На мобильных устройствах изображения не оптимизированы под размер экрана. Например, в главную карусель при ширине экрана в 320 пикселей загружается картинка в 1920. [Скриншот](https://github.com/Urkass/task5_optimization/tree/master/screenshots/roomfi.png). Стоит подготовить под различные устройства картинки разного размера и вставить, используя тэг picture, аттрибут srcset у тэга img или media-queries.

* Все картинки необходимо оптимизировать. Например, [данную картинку](http://roomfi.ru/template_main/img/bg_move.jpg) можно сжать без потерь, уменьшив ее изначальный вес на 2%. Сжать ее с потерями, не видимыми человеческому глазу можно на 45%. Итоговый вес снизится с 187 Килобайт до 102 Килобайт

### Шрифты
* Для всех иконок используется шрифт FontAwesome. Мне кажется, что в данном случае лучше добавить SVG спрайт с нужными иконками, чем тащить за собой целый шрифт.
